"0","s = x = rep(NA, n)"
"0","s[1] = sample(1:2, 1, prob = delta)"
"0","x[1] = rnorm(1, beta[s[1],]%*%c(1, Z[1,]), # state-dependent regression"
"0","                    sigma[s[1]])"
"0","for(t in 2:n){"
"0","  s[t] = sample(1:2, 1, prob = Gamma[s[t-1],])"
"0","  x[t] = rnorm(1, beta[s[t],]%*%c(1, Z[t,]), # state-dependent regression"
"0","                      sigma[s[t]])"
"0","}"
"0",""
"0","par(mfrow = c(1,2))"
"0","plot(x[1:400], bty = ""n"", pch = 20, ylab = ""x"", "
"0","     col = c(color[1], color[2])[s[1:400]])"
