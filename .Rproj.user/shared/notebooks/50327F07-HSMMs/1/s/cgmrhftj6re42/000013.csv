"0","set.seed(123)"
"0",""
"0","k = 50 # number of stays"
"0","s = rep(NA, k)"
"0","s[1] = sample(1:3, 1) # uniform initial distribution"
"0","staylength = rpois(1, lambda[s[1]]) + 1 # drawing dwell time from shifted Poisson"
"0","C = rep(s[1], staylength)"
"0","x = rnorm(staylength, mu[s[1]], sigma[s[1]])"
"0",""
"0","for(t in 2:k){"
"0","  # conditionally drawing state"
"0","  s[t] = sample(c(1:3)[-s[t-1]], 1, prob = omega[s[t-1], -s[t-1]])"
"0","  staylength = rpois(1, lambda[s[t]]) + 1 # drawing dwell time from shifted Poisson"
"0","  "
"0","  C = c(C, rep(s[t], staylength))"
"0","  x = c(x, rnorm(staylength, mu[s[t]], sigma[s[t]]))"
"0","}"
"0",""
"0","plot(x, pch = 20, col = color[C], bty = ""n"")"
