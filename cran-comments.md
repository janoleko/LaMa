Minor efficiency and stability upgrades 