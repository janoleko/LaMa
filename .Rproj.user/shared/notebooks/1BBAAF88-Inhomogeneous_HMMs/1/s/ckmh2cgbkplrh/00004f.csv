"0","# transform parameters to working"
"0","beta_hat = matrix(mod$estimate[1:6], nrow = 2)"
"0","Gamma_hat = tpm_g(Z = Z[-1,], beta_hat)"
"0","delta_hat = c(1, exp(mod$estimate[7]))"
"0","delta_hat = delta_hat / sum(delta_hat)"
"0","mu_hat = mod$estimate[8:9]"
"0","sigma_hat = exp(mod$estimate[10:11])"
"0",""
"0","# we calculate the average state distribution overall all covariate values"
"0","zseq = seq(-2, 2, by = 0.01)"
"0","Gamma_seq = tpm_g(Z = cbind(zseq, zseq^2), beta_hat)"
"0","Prob = matrix(nrow = length(zseq), ncol = 2)"
"0","for(i in 1:length(zseq)){ Prob[i,] = stationary(Gamma_seq[,,i]) }"
"0","prob = apply(Prob, 2, mean)"
"0",""
"0","par(mfrow = c(1,1))"
"0","hist(x, prob = TRUE, bor = ""white"", breaks = 20, main = """")"
