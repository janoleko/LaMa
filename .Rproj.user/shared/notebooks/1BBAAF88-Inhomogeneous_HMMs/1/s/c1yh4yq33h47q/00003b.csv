"0","# parameters"
"0","mu = c(5, 20)"
"0","sigma = c(4, 5)"
"0",""
"0","beta = matrix(c(-2, -2, # intercepts"
"0","                -1, 0.5, # linear effects"
"0","                0.25, -0.25), # quadratic effects"
"0","              nrow = 2)"
"0",""
"0","n = 1000"
"0","set.seed(123)"
"0","z = rnorm(n) # in practice there will be n covariate values."
"0","# However, we only have n-1 transitions, thererfore we only need n-1 values:"
"0","Z = cbind(z, z^2) # quadratic effect of z"
"0","Gamma = tpm_g(Z = Z[-1,], beta) # of dimension c(2, 2, n-1)"
"0","delta = c(0.5, 0.5) # non-stationary initial distribution"
"0",""
"0","color = c(""orange"", ""deepskyblue"")"
"0",""
"0","par(mfrow = c(1,2))"
"0","zseq = seq(-2,2,by = 0.01)"
"0","Gamma_seq = tpm_g(Z = cbind(zseq, zseq^2), beta)"
"0","plot(zseq, Gamma_seq[1,2,], type = ""l"", lwd = 3, bty = ""n"", ylim = c(0,1), "
"0","     xlab = ""z"", ylab = ""gamma_12"", col = color[1])"
