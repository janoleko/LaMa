<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Computes generalised quadratic-form penalties — penalty2 • LaMa</title><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Computes generalised quadratic-form penalties — penalty2"><meta name="description" content="This function computes a quadratic penalty of the form
$$0.5 \sum_{i} \lambda_i b^T S_i b,$$
with smoothing parameters \(\lambda_i\), coefficient vector \(b\), and fixed penalty matrices \(S_i\).
This generalises the penalty by allowing subsets of the coefficient vector  \(b\) to be penalised multiple times with different smoothing parameters, which is necessary for tensor products, functional random effects or adaptive smoothing.
It is intended to be used inside the penalised negative log-likelihood function when fitting models with penalised splines or simple random effects via quasi restricted maximum likelihood (qREML) with the qreml function.
For qreml to work, the likelihood function needs to be compatible with the RTMB R package to enable automatic differentiation."><meta property="og:description" content="This function computes a quadratic penalty of the form
$$0.5 \sum_{i} \lambda_i b^T S_i b,$$
with smoothing parameters \(\lambda_i\), coefficient vector \(b\), and fixed penalty matrices \(S_i\).
This generalises the penalty by allowing subsets of the coefficient vector  \(b\) to be penalised multiple times with different smoothing parameters, which is necessary for tensor products, functional random effects or adaptive smoothing.
It is intended to be used inside the penalised negative log-likelihood function when fitting models with penalised splines or simple random effects via quasi restricted maximum likelihood (qREML) with the qreml function.
For qreml to work, the likelihood function needs to be compatible with the RTMB R package to enable automatic differentiation."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">LaMa</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Continuous_time_HMMs.html">Continuous-time HMMs</a></li>
    <li><a class="dropdown-item" href="../articles/HSMMs.html">Hidden semi-Markov models</a></li>
    <li><a class="dropdown-item" href="../articles/Inhomogeneous_HMMs.html">Inhomogeneous HMMs</a></li>
    <li><a class="dropdown-item" href="../articles/Intro_to_LaMa.html">Introduction to LaMa</a></li>
    <li><a class="dropdown-item" href="../articles/LaMa_and_RTMB.html">LaMa and RTMB</a></li>
    <li><a class="dropdown-item" href="../articles/Longitudinal_data.html">Longitudinal data</a></li>
    <li><a class="dropdown-item" href="../articles/MMMPPs.html">Markov-modulated (marked) Poisson processes</a></li>
    <li><a class="dropdown-item" href="../articles/Penalised_splines.html">Penalised splines</a></li>
    <li><a class="dropdown-item" href="../articles/Periodic_HMMs.html">Periodic HMMs</a></li>
    <li><a class="dropdown-item" href="../articles/State_space_models.html">State-space models</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Computes generalised quadratic-form penalties</h1>

      <div class="d-none name"><code>penalty2.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes a quadratic penalty of the form
$$0.5 \sum_{i} \lambda_i b^T S_i b,$$
with smoothing parameters \(\lambda_i\), coefficient vector \(b\), and fixed penalty matrices \(S_i\).
This generalises the <code><a href="penalty.html">penalty</a></code> by allowing subsets of the coefficient vector  \(b\) to be penalised multiple times with different smoothing parameters, which is necessary for <strong>tensor products</strong>, <strong>functional random effects</strong> or <strong>adaptive smoothing</strong>.</p>
<p>It is intended to be used inside the <strong>penalised negative log-likelihood function</strong> when fitting models with penalised splines or simple random effects via <strong>quasi restricted maximum likelihood</strong> (qREML) with the <code><a href="qreml.html">qreml</a></code> function.
For <code><a href="qreml.html">qreml</a></code> to work, the likelihood function needs to be compatible with the <code>RTMB</code> R package to enable automatic differentiation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">penalty2</span><span class="op">(</span><span class="va">re_coef</span>, <span class="va">S</span>, <span class="va">lambda</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-re-coef">re_coef<a class="anchor" aria-label="anchor" href="#arg-re-coef"></a></dt>
<dd><p>list of coefficient vectors/ matrices</p>
<p>Each list entry corresponds to a different smooth/ random effect with its own associated penalty matrix or penalty-matrix list in <code>S</code>.
When several smooths/ random effects of the same kind are present, it is convenient to pass them as a matrix, where each row corresponds to one smooth/ random effect.
This way all rows can use the same penalty matrix.</p></dd>


<dt id="arg-s">S<a class="anchor" aria-label="anchor" href="#arg-s"></a></dt>
<dd><p>list of fixed penalty matrices matching the structure of <code>re_coef</code>.</p>
<p>This means if <code>re_coef</code> is of length 3, then <code>S</code> needs to be a list of length 3. Each entry needs to be either a penalty matrix, matching the dimension of the corresponding entry in <code>re_coef</code>, or a list with multiple penalty matrices for tensor products.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>penalty strength parameter vector that has a length corresponding to the provided <code>re_coef</code> and <code>S</code>.</p>
<p>Specifically, for entries with one penalty matrix, <code>nrow(re_coef[[i]])</code> parameters are needed. For entries with <code>k</code> penalty matrices, <code>k * nrow(re_coef[[i]])</code> parameters are needed.</p>
<p>E.g. if <code>re_coef[[1]]</code> is a vector and <code>re_coef[[2]]</code> a matrix with 4 rows,
<code>S[[1]]</code> is a list of length 2 and <code>S[[2]]</code> is a matrix, then <code>lambda</code> needs to be of length 1 * 2 + 4 = 6.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>returns the penalty value and reports to <code><a href="qreml.html">qreml</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Caution:</strong> The formatting of <code>re_coef</code> needs to match the structure of the parameter list in your penalised negative log-likelihood function,
i.e. you cannot have two random effect vectors of different names (different list elements in the parameter list), combine them into a matrix inside your likelihood and pass the matrix to <code>penalty</code>.
If these are seperate random effects, each with its own name, they need to be passed as a list to <code>penalty</code>. Moreover, the ordering of <code>re_coef</code> needs to match the character vector <code>random</code> specified in <code><a href="qreml.html">qreml</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="qreml.html">qreml</a></code> for the <strong>qREML</strong> algorithm</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example with a single random effect</span></span></span>
<span class="r-in"><span><span class="va">re</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">S</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lambda</span> <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="fu"><a href="penalty.html">penalty</a></span><span class="op">(</span><span class="va">re</span>, <span class="va">S</span>, <span class="va">lambda</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example with two random effects, </span></span></span>
<span class="r-in"><span><span class="co"># where one element contains two random effects of similar structure</span></span></span>
<span class="r-in"><span><span class="va">re</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">S</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lambda</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span> <span class="co"># length = total number of random effects</span></span></span>
<span class="r-in"><span><span class="fu"><a href="penalty.html">penalty</a></span><span class="op">(</span><span class="va">re</span>, <span class="va">S</span>, <span class="va">lambda</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Full model-fitting example</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">=</span> <span class="va">trex</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>,<span class="op">]</span> <span class="co"># subset</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># initial parameter list</span></span></span>
<span class="r-in"><span><span class="va">par</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>logmu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="co"># step mean</span></span></span>
<span class="r-in"><span>           logsigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span>, <span class="co"># step sd</span></span></span>
<span class="r-in"><span>           beta0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="op">-</span><span class="fl">2</span><span class="op">)</span>, <span class="co"># state process intercept</span></span></span>
<span class="r-in"><span>           betaspline <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">18</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># state process spline coefs</span></span></span>
<span class="r-in"><span>          </span></span>
<span class="r-in"><span><span class="co"># data object with initial penalty strength lambda</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>step <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">step</span>, <span class="co"># step length</span></span></span>
<span class="r-in"><span>           tod <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">tod</span>, <span class="co"># time of day covariate</span></span></span>
<span class="r-in"><span>           N <span class="op">=</span> <span class="fl">2</span>, <span class="co"># number of states</span></span></span>
<span class="r-in"><span>           lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># initial penalty strength</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># building model matrices</span></span></span>
<span class="r-in"><span><span class="va">modmat</span> <span class="op">=</span> <span class="fu"><a href="make_matrices.html">make_matrices</a></span><span class="op">(</span><span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">tod</span>, bs <span class="op">=</span> <span class="st">"cp"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                       data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>tod <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">24</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                       knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>tod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">24</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># wrapping points</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">Z</span> <span class="op">=</span> <span class="va">modmat</span><span class="op">$</span><span class="va">Z</span> <span class="co"># spline design matrix</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">S</span> <span class="op">=</span> <span class="va">modmat</span><span class="op">$</span><span class="va">S</span> <span class="co"># penalty matrix</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># penalised negative log-likelihood function</span></span></span>
<span class="r-in"><span><span class="va">pnll</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/RTMB/man/TMB-interface.html" class="external-link">getAll</a></span><span class="op">(</span><span class="va">par</span>, <span class="va">dat</span><span class="op">)</span> <span class="co"># makes everything contained available without $</span></span></span>
<span class="r-in"><span>  <span class="va">Gamma</span> <span class="op">=</span> <span class="fu"><a href="tpm_g.html">tpm_g</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">beta0</span>, <span class="va">betaspline</span><span class="op">)</span><span class="op">)</span> <span class="co"># transition probabilities</span></span></span>
<span class="r-in"><span>  <span class="va">delta</span> <span class="op">=</span> <span class="fu"><a href="stationary_p.html">stationary_p</a></span><span class="op">(</span><span class="va">Gamma</span>, t <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># initial distribution</span></span></span>
<span class="r-in"><span>  <span class="va">mu</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">logmu</span><span class="op">)</span> <span class="co"># step mean</span></span></span>
<span class="r-in"><span>  <span class="va">sigma</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">logsigma</span><span class="op">)</span> <span class="co"># step sd</span></span></span>
<span class="r-in"><span>  <span class="co"># calculating all state-dependent densities</span></span></span>
<span class="r-in"><span>  <span class="va">allprobs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">step</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">N</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ind</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">step</span><span class="op">)</span><span class="op">)</span> <span class="co"># only for non-NA obs.</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">N</span><span class="op">)</span> <span class="va">allprobs</span><span class="op">[</span><span class="va">ind</span>,<span class="va">j</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="gamma2.html">dgamma2</a></span><span class="op">(</span><span class="va">step</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span>,<span class="va">mu</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,<span class="va">sigma</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">-</span><span class="fu"><a href="forward_g.html">forward_g</a></span><span class="op">(</span><span class="va">delta</span>, <span class="va">Gamma</span><span class="op">[</span>,,<span class="va">tod</span><span class="op">]</span>, <span class="va">allprobs</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="penalty.html">penalty</a></span><span class="op">(</span><span class="va">betaspline</span>, <span class="va">S</span>, <span class="va">lambda</span><span class="op">)</span> <span class="co"># this does all the penalization work</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># model fitting</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">=</span> <span class="fu"><a href="qreml.html">qreml</a></span><span class="op">(</span><span class="va">pnll</span>, <span class="va">par</span>, <span class="va">dat</span>, random <span class="op">=</span> <span class="st">"betaspline"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Creating AD function</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Performance tip: Consider running `TapeConfig(matmul = 'plain')` before `MakeADFun()` to speed up the forward algorithm.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initialising with lambda: 10 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 1 - lambda: 5.545 5.001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 2 - lambda: 3.289 3.001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 3 - lambda: 2.081 2.091 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 4 - lambda: 1.406 1.599 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 5 - lambda: 1.018 1.293 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 6 - lambda: 0.79 1.08 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 7 - lambda: 0.654 0.92 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 8 - lambda: 0.573 0.794 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 9 - lambda: 0.525 0.69 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 10 - lambda: 0.497 0.602 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 11 - lambda: 0.48 0.526 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 12 - lambda: 0.471 0.46 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 13 - lambda: 0.467 0.403 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 14 - lambda: 0.465 0.353 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 15 - lambda: 0.465 0.31 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 16 - lambda: 0.466 0.272 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 17 - lambda: 0.467 0.24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 18 - lambda: 0.469 0.214 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 19 - lambda: 0.472 0.191 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 20 - lambda: 0.474 0.172 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 21 - lambda: 0.476 0.157 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 22 - lambda: 0.478 0.144 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 23 - lambda: 0.48 0.134 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 24 - lambda: 0.481 0.126 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 25 - lambda: 0.483 0.119 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 26 - lambda: 0.484 0.114 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 27 - lambda: 0.485 0.109 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 28 - lambda: 0.486 0.106 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 29 - lambda: 0.487 0.103 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 30 - lambda: 0.488 0.101 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 31 - lambda: 0.488 0.099 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 32 - lambda: 0.489 0.097 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 33 - lambda: 0.489 0.096 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 34 - lambda: 0.489 0.095 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 35 - lambda: 0.49 0.094 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 36 - lambda: 0.49 0.094 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 37 - lambda: 0.49 0.093 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 38 - lambda: 0.49 0.093 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer 39 - lambda: 0.49 0.093 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Final model fit with lambda: 0.49 0.093 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jan-Ole Koslik.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

