"0","# simulation"
"0","z = rep(1:48, 50) # time of day variable, 50 days"
"0","n = length(z)"
"0","set.seed(123)"
"0","s = x = rep(NA, n)"
"0","s[1] = sample(1:2, 1, prob = Delta[z[1],])"
"0","x[1] = stats::rnorm(1, mu[s[1]], sigma[s[1]])"
"0","for(t in 2:n){"
"0","  s[t] = sample(1:2, 1, prob = Gamma[s[t-1],,z[t]])"
"0","  x[t] = rnorm(1, mu[s[t]], sigma[s[t]])"
"0","}"
"0",""
"0","par(mfrow = c(1,2))"
"0","plot(x[1:400], bty = ""n"", pch = 20, ylab = ""x"", "
"0","     col = c(color[1], color[2])[s[1:400]])"
