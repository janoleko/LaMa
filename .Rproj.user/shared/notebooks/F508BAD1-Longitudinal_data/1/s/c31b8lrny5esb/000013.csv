"0","# parameters are shared across individuals"
"0","mu = c(15, 60)"
"0","sigma = c(10, 40)"
"0","Gamma = matrix(c(0.95, 0.05, 0.15, 0.85), nrow = 2, byrow = TRUE)"
"0","delta = stationary(Gamma) # stationary HMM"
"0",""
"0","# simulation of all tracks"
"0","set.seed(123)"
"0","K = 200 # number of individuals, for example different animals"
"0","n = 50 # observations per animal only (but many animals)"
"0",""
"0","s = x = rep(NA, n*K)"
"0","for(k in 1:K){"
"0","  sk = xk = rep(NA, n)"
"0","  sk[1] = sample(1:2, 1, prob = delta)"
"0","  xk[1] = rnorm(1, mu[sk[1]], sigma[sk[1]])"
"0","  for(t in 2:n){"
"0","    sk[t] = sample(1:2, 1, prob = Gamma[sk[t-1],]) "
"0","    xk[t] = rnorm(1, mu[sk[t]], sigma[sk[t]])"
"0","  }"
"0","  s[(k-1)*n + 1:n] = sk"
"0","  x[(k-1)*n + 1:n] = xk"
"0","}"
"0",""
"0","trackID = rep(1:K, each = n)"
