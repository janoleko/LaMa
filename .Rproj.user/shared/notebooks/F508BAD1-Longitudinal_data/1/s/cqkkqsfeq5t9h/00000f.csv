"0","# fast version using trackInd in forward()"
"0","mllk_pool = function(theta.star, x, trackID){"
"0","  Gamma = tpm(theta.star[1:2])"
"0","  delta = stationary(Gamma)"
"0","  mu = theta.star[3:4]"
"0","  sigma = exp(theta.star[5:6])"
"0","  allprobs = matrix(1, length(x), 2)"
"0","  for(j in 1:2){ allprobs[,j] = dnorm(x, mu[j], sigma[j]) }"
"0","  "
"0","  # here we add trackInd as an argument to forward()"
"0","  -forward(delta, Gamma, allprobs, trackID)"
"0","}"
"0",""
"0","# slow alternative looping over individuals in R"
"0","mllk_pool_slow = function(theta.star, x, K){"
"0","  n = length(x) / K"
"0","  Gamma = tpm(theta.star[1:2])"
"0","  delta = stationary(Gamma)"
"0","  mu = theta.star[3:4]"
"0","  sigma = exp(theta.star[5:6])"
"0","  allprobs = matrix(1, length(x), 2)"
"0","  for(j in 1:2){ allprobs[,j] = dnorm(x, mu[j], sigma[j]) }"
"0","  "
"0","  # here we just loop over individuals in R"
"0","  l = 0"
"0","  for(k in 1:K){"
"0","    l = l + forward(delta, Gamma, allprobs[(k-1)*n + 1:n,])"
"0","  }"
"0","  -l"
"0","}"
