"0","# parameter estimates"
"0","(phi = plogis(mod$estimate[1]))"
"1","[1]"
"1"," 0.9305141"
"1","
"
"0","(sigma = exp(mod$estimate[2]))"
"1","[1]"
"1"," 0.4805211"
"1","
"
"0","(beta = exp(mod$estimate[3]))"
"1","[1]"
"1"," 2.50383"
"1","
"
"0","# decoding states"
"0","b = seq(-bm, bm, length = m+1) # intervals for midpoint quadrature"
"0","h = b[2]-b[1] # interval width"
"0","bstar = (b[-1] + b[-(m+1)])/2 # interval midpoints"
"0","Gamma = sapply(bstar, dnorm, mean = phi*bstar, sd = sigma) * h"
"0","Gamma = Gamma / rowSums(Gamma) # normalizing out approximation errors"
"0","delta = h * dnorm(bstar, 0, sigma/sqrt(1-phi^2)) # stationary distribution"
"0","# approximating state-dependent density based on midpoints"
"0","allprobs = t(sapply(y, dnorm, mean = 0, sd = beta * exp(bstar/2)))"
"0",""
"0","probs = stateprobs(delta, Gamma, allprobs)"
"0","states = viterbi(delta, Gamma, allprobs)"
"0",""
"0","par(mar = c(5,4,3,4.5)+0.1)"
"0","plot(y, type = ""l"", bty = ""n"", ylim = c(-50,20), yaxt = ""n"")"
